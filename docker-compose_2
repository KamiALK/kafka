
import { Kafka, Partitioners } from "kafkajs";
import dotenv from "dotenv";

dotenv.config();

const kafka = new Kafka({
  clientId: process.env.KAFKA_CLIENT_ID,
  broker: process.env.KAFKA_BROKERS,
});
const producer = kafka.producer({ createPartitioner: Partitioners.LegacyPartitioner });

export async function sendKafkaMessage(topic, message) {
  await producer.connect();
  await producer.send({
    topic,
    messages: [{ value: message }],
  });
  await producer.disconnect();
}
